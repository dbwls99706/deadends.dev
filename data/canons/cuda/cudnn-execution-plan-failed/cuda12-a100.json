{
  "schema_version": "1.0.0",
  "id": "cuda/cudnn-execution-plan-failed/cuda12-a100",
  "url": "https://deadends.dev/cuda/cudnn-execution-plan-failed/cuda12-a100",
  "error": {
    "signature": "RuntimeError: cuDNN error: CUDNN_STATUS_EXECUTION_FAILED",
    "regex": "cuDNN error.*CUDNN_STATUS_EXECUTION_FAILED|CUDNN_STATUS_EXECUTION_FAILED",
    "domain": "cuda",
    "category": "runtime_error",
    "first_seen": "2021-01-01",
    "last_confirmed": "2026-02-14"
  },
  "environment": {
    "runtime": {
      "name": "pytorch",
      "version_range": ">=1.12,<2.5"
    },
    "os": "linux",
    "hardware": {
      "gpu": "A100-80GB",
      "vram_gb": 80
    }
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.8,
    "confidence": 0.8,
    "last_updated": "2026-02-14",
    "summary": "cuDNN fails to execute a convolution or attention kernel. Often caused by cuDNN benchmark mode selecting an algorithm that doesn't work for the specific input shape, or by a cuDNN/CUDA version incompatibility."
  },
  "dead_ends": [
    {
      "action": "Reinstalling PyTorch without checking cuDNN version compatibility",
      "why_fails": "PyTorch bundles its own cuDNN, but if CUDA driver version is too old for the bundled cuDNN, or if LD_LIBRARY_PATH points to a system cuDNN that conflicts, reinstalling PyTorch alone doesn't resolve the mismatch.",
      "fail_rate": 0.65,
      "sources": [
        "https://docs.nvidia.com/cuda/"
      ],
      "condition": ""
    },
    {
      "action": "Reducing batch size as a general fix",
      "why_fails": "CUDNN_STATUS_EXECUTION_FAILED is not an OOM error. Reducing batch size changes input dimensions, which may cause cuDNN to select a different algorithm that happens to work, but this masks the real issue and breaks reproducibility.",
      "fail_rate": 0.6,
      "sources": [
        "https://docs.nvidia.com/cuda/"
      ],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Disable cuDNN benchmark mode to use deterministic algorithm selection",
      "how": "import torch\ntorch.backends.cudnn.benchmark = False\ntorch.backends.cudnn.deterministic = True\n# This prevents cuDNN from auto-tuning algorithms, avoiding the problematic one",
      "success_rate": 0.85,
      "sources": [
        "https://pytorch.org/docs/stable/backends.html#torch.backends.cudnn.benchmark"
      ],
      "condition": "Error occurs intermittently or only with specific input shapes"
    },
    {
      "action": "Ensure cuDNN version matches the CUDA toolkit and driver version",
      "how": "# Check versions:\npython -c \"import torch; print(torch.backends.cudnn.version())\"\nnvidia-smi  # Check driver version\nnvcc --version  # Check CUDA toolkit\n# Install matching PyTorch:\npip install torch --index-url https://download.pytorch.org/whl/cu121",
      "success_rate": 0.8,
      "sources": [
        "https://pytorch.org/get-started/locally/"
      ],
      "condition": "Version mismatch between cuDNN, CUDA, and driver"
    },
    {
      "action": "Use torch.backends.cuda.preferred_linalg_library('default') and disable TF32 for debugging",
      "how": "import torch\ntorch.backends.cuda.matmul.allow_tf32 = False\ntorch.backends.cudnn.allow_tf32 = False\n# If error disappears, TF32 precision is the issue. A100-specific.",
      "success_rate": 0.75,
      "sources": [
        "https://pytorch.org/docs/stable/notes/cuda.html#tf32-on-ampere"
      ],
      "condition": "On Ampere GPUs (A100, A30) with TF32 enabled"
    }
  ],
  "transition_graph": {
    "leads_to": [],
    "preceded_by": [
      {
        "error_id": "cuda/cudnn-version-mismatch/cuda12-a100",
        "probability": 0.3,
        "condition": "Version mismatch warnings may appear before execution failure"
      }
    ],
    "frequently_confused_with": [
      {
        "error_id": "cuda/cudnn-not-compiled/cuda12-a100",
        "distinction": "CUDNN_STATUS_EXECUTION_FAILED occurs at runtime when a selected algorithm fails during execution. 'cuDNN not compiled with support' is a compile-time or load-time error indicating the cuDNN library itself lacks the required feature."
      }
    ]
  },
  "metadata": {
    "generated_by": "expert_review",
    "generation_date": "2026-02-14",
    "review_status": "auto_generated",
    "evidence_count": 60,
    "last_verification": "2026-02-14"
  }
}
