{
  "schema_version": "1.0.0",
  "id": "cuda/nccl-unhandled-system-error/torch2.1-multi-gpu",
  "url": "https://deadends.dev/cuda/nccl-unhandled-system-error/torch2.1-multi-gpu",
  "error": {
    "signature": "RuntimeError: NCCL error: unhandled system error, NCCL version",
    "regex": "NCCL.*unhandled system error|NCCL.*system error|nccl.*SystemError",
    "domain": "cuda",
    "category": "distributed_error",
    "first_seen": "2023-01-01",
    "last_confirmed": "2026-02-11"
  },
  "environment": {
    "runtime": {
      "name": "cuda",
      "version_range": ">=12.0,<13.0"
    },
    "os": "linux",
    "hardware": {
      "gpu": "multi-gpu"
    }
  },
  "verdict": {
    "resolvable": "partial",
    "fix_success_rate": 0.75,
    "confidence": 0.82,
    "last_updated": "2026-02-11",
    "summary": "NCCL multi-GPU communication failed. Network, driver, or IPC issue."
  },
  "dead_ends": [
    {
      "action": "Set NCCL_DEBUG=INFO for more details (and stop there)",
      "why_fails": "DEBUG helps diagnose but doesn't fix the issue",
      "fail_rate": 0.5,
      "sources": [
        "https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/env.html"
      ],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Set NCCL_SOCKET_IFNAME to the correct network interface",
      "success_rate": 0.88,
      "how": "export NCCL_SOCKET_IFNAME=eth0",
      "sources": [
        "https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/env.html#nccl-socket-ifname"
      ],
      "condition": ""
    },
    {
      "action": "Update NVIDIA driver and NCCL to latest compatible versions",
      "success_rate": 0.85,
      "sources": [
        "https://docs.nvidia.com/deeplearning/nccl/install-guide/index.html"
      ],
      "condition": "",
      "how": "# Check current versions:\nnvidia-smi  # Driver version\nnvcc --version  # CUDA version\npython -c \"import torch; print(torch.cuda.nccl.version())\"\n\n# Update driver:\nsudo apt-get install nvidia-driver-545\n# Update NCCL:\nconda install -c nvidia nccl"
    },
    {
      "action": "Try NCCL_P2P_DISABLE=1 if peer-to-peer GPU communication fails",
      "success_rate": 0.8,
      "sources": [
        "https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/env.html"
      ],
      "condition": "",
      "how": "export NCCL_P2P_DISABLE=1\n# Also try disabling IB if on InfiniBand:\nexport NCCL_IB_DISABLE=1\n# Then rerun training:\ntorchrun --nproc_per_node=4 train.py"
    }
  ],
  "transition_graph": {
    "leads_to": [],
    "preceded_by": [],
    "frequently_confused_with": [
      {
        "error_id": "cuda/all-cuda-capable-devices-busy/cuda12-linux",
        "distinction": "'RuntimeError' is a distributed_error error while 'RuntimeError' has a different failure mode despite similar symptoms. Check error message details to differentiate."
      }
    ]
  },
  "metadata": {
    "generated_by": "bulk_generate.py",
    "generation_date": "2026-02-11",
    "review_status": "auto_generated",
    "evidence_count": 50,
    "last_verification": "2026-02-11"
  }
}
