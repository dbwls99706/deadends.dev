{
  "schema_version": "1.0.0",
  "id": "database/mongodb-authentication-failed/mongo7-linux",
  "url": "https://deadends.dev/database/mongodb-authentication-failed/mongo7-linux",
  "error": {
    "signature": "pymongo.errors.OperationFailure: Authentication failed., full error: {'ok': 0, 'errmsg': 'Authentication failed.', 'code': 18}",
    "regex": "Authentication failed.*code.*18|MongoServerError: Authentication failed",
    "domain": "database",
    "category": "authentication_error",
    "first_seen": "2023-06-01",
    "last_confirmed": "2026-02-12"
  },
  "environment": {
    "runtime": {
      "name": "mongodb",
      "version_range": ">=7.0,<8.0"
    },
    "os": "linux"
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.9,
    "confidence": 0.92,
    "last_updated": "2026-02-12",
    "summary": "MongoDB rejected the authentication attempt. Commonly caused by wrong password, wrong authentication database (authSource), user not existing in the specified database, or SCRAM mechanism mismatch between client and server."
  },
  "dead_ends": [
    {
      "action": "Creating the user in the application database instead of the authSource database",
      "why_fails": "MongoDB authenticates users against a specific database (authSource, typically 'admin'). Creating a user in 'myappdb' does not help if the client authenticates against 'admin'. The user must exist in the authentication database.",
      "fail_rate": 0.85,
      "sources": [
        "https://www.mongodb.com/docs/manual/"
      ],
      "condition": ""
    },
    {
      "action": "Disabling authentication by removing the security.authorization setting",
      "why_fails": "Disabling authentication in production exposes the database to unauthorized access. MongoDB has been a frequent target of ransomware attacks on open instances. This is a security anti-pattern, not a fix.",
      "fail_rate": 0.7,
      "sources": [
        "https://www.mongodb.com/docs/manual/"
      ],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Specify the correct authSource in the connection string",
      "success_rate": 0.92,
      "how": "Include authSource in the URI: mongodb://user:pass@host:27017/mydb?authSource=admin. The authSource must match the database where the user was created (usually 'admin'). Check with: use admin; db.getUsers(); in mongosh.",
      "sources": [],
      "condition": ""
    },
    {
      "action": "Recreate the user with the correct credentials and roles",
      "success_rate": 0.88,
      "how": "Connect without auth (if possible) or use another admin account. Run: use admin; db.dropUser('myuser'); db.createUser({ user: 'myuser', pwd: 'newpassword', roles: [{ role: 'readWrite', db: 'mydb' }] }); Then update the application connection string.",
      "sources": [],
      "condition": ""
    }
  ],
  "transition_graph": {
    "leads_to": [
      {
        "error_id": "database/mongodb-namespace-not-found/mongo7-linux",
        "probability": 0.15,
        "condition": "when user authenticates to wrong database that lacks expected collections"
      }
    ],
    "preceded_by": [
      {
        "error_id": "database/mongodb-connection-failed/mongo7-linux",
        "probability": 0.3,
        "condition": "when server becomes reachable but authentication is enabled"
      }
    ],
    "frequently_confused_with": [
      {
        "error_id": "database/authentication-failed/pg16-linux",
        "distinction": "MongoDB authentication failure (code 18) includes authSource complexity that PostgreSQL lacks. MongoDB users are scoped to databases, while PostgreSQL users are cluster-wide. MongoDB uses 'authSource' parameter, PostgreSQL does not have this concept."
      }
    ]
  },
  "metadata": {
    "generated_by": "bulk_generate.py",
    "generation_date": "2026-02-12",
    "review_status": "auto_generated",
    "evidence_count": 55,
    "last_verification": "2026-02-12"
  }
}
