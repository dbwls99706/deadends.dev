{
  "schema_version": "1.0.0",
  "id": "docker/no-space-left/docker24-linux",
  "url": "https://deadend.dev/docker/no-space-left/docker24-linux",

  "error": {
    "signature": "no space left on device",
    "regex": "no space left on device",
    "domain": "docker",
    "category": "storage",
    "first_seen": "2015-01-01",
    "last_confirmed": "2025-05-05"
  },

  "environment": {
    "runtime": { "name": "docker", "version_range": ">=20,<26" },
    "os": "linux",
    "additional": {}
  },

  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.88,
    "confidence": 0.90,
    "last_updated": "2025-05-05",
    "summary": "Docker 'no space left on device' on Linux is caused by accumulated images, containers, volumes, and build cache consuming disk space in /var/lib/docker. The fix involves pruning unused Docker objects and potentially moving the Docker data root to a larger partition."
  },

  "dead_ends": [
    {
      "action": "Running 'docker system prune' without the --volumes flag",
      "why_fails": "The default 'docker system prune' does NOT remove volumes. Docker volumes often consume the most space (databases, application data) and are the primary cause of disk exhaustion. Without --volumes, the prune may free little space.",
      "fail_rate": 0.55,
      "sources": [
        "https://docs.docker.com/reference/cli/docker/system/prune/"
      ],
      "common_misconception": "Many developers believe 'docker system prune' cleans everything, but it deliberately preserves volumes to prevent data loss. You must explicitly opt in to volume removal."
    },
    {
      "action": "Manually deleting files from /var/lib/docker",
      "why_fails": "The /var/lib/docker directory has a complex internal structure managed by Docker's storage drivers (overlay2, btrfs, etc.). Manually deleting files corrupts Docker's internal state, leading to broken containers, orphaned layers, and potentially an unrecoverable Docker installation.",
      "fail_rate": 0.90,
      "sources": [
        "https://docs.docker.com/engine/storage/drivers/"
      ]
    }
  ],

  "workarounds": [
    {
      "action": "Run a comprehensive Docker prune including volumes",
      "how": "docker system prune -a --volumes --force. The '-a' flag removes all unused images (not just dangling ones), and '--volumes' removes unused volumes. Warning: this removes ALL data in unnamed volumes. Verify no important data is in volumes first with 'docker volume ls'.",
      "success_rate": 0.90,
      "tradeoff": "Destroys all data in unused volumes; all images must be re-pulled; build cache is cleared, slowing subsequent builds",
      "sources": [
        "https://docs.docker.com/reference/cli/docker/system/prune/"
      ]
    },
    {
      "action": "Move Docker's data root to a larger partition",
      "how": "Stop Docker: 'sudo systemctl stop docker'. Edit /etc/docker/daemon.json and add: {\"data-root\": \"/mnt/large-disk/docker\"}. Copy existing data: 'sudo rsync -aP /var/lib/docker/ /mnt/large-disk/docker/'. Start Docker: 'sudo systemctl start docker'. Verify with 'docker info | grep Root'.",
      "success_rate": 0.85,
      "tradeoff": "Requires a larger partition to be available; rsync of large data directories can take significant time; must stop all containers during migration",
      "condition": "The root partition is too small and a larger disk or partition is available",
      "sources": [
        "https://docs.docker.com/engine/daemon/#daemon-data-directory"
      ]
    },
    {
      "action": "Set up automatic pruning with a cron job or Docker's built-in log rotation",
      "how": "Add to crontab: '0 2 * * 0 docker system prune -af --filter \"until=168h\"' (weekly prune of resources older than 7 days). For log rotation, add to /etc/docker/daemon.json: {\"log-driver\": \"json-file\", \"log-opts\": {\"max-size\": \"10m\", \"max-file\": \"3\"}}.",
      "success_rate": 0.80,
      "tradeoff": "Preventive measure; does not immediately free space but prevents recurrence. Log rotation requires daemon restart.",
      "sources": []
    }
  ],

  "transition_graph": {
    "leads_to": [
      {
        "error_id": "docker/build-failed-disk/docker24-linux",
        "probability": 0.50,
        "condition": "Disk full causes docker build to fail mid-layer",
        "typical_delay": "immediate"
      }
    ],
    "preceded_by": [],
    "frequently_confused_with": [
      {
        "error_id": "docker/overlay2-high-usage/docker24-linux",
        "distinction": "'no space left on device' is the kernel error when the filesystem is full. Overlay2 high usage is a Docker-specific storage driver issue where layers accumulate. The former is a hard failure; the latter is a gradual degradation visible via 'docker system df'."
      }
    ]
  },

  "metadata": {
    "generated_by": "deadend-seed-v1",
    "generation_date": "2025-06-01",
    "review_status": "auto_generated",
    "evidence_count": 55,
    "page_views": 0,
    "ai_agent_hits": 0,
    "human_hits": 0,
    "last_verification": "2025-06-01"
  }
}
