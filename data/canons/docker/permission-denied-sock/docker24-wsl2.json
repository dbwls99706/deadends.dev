{
  "schema_version": "1.0.0",
  "id": "docker/permission-denied-sock/docker24-wsl2",
  "url": "https://deadends.dev/docker/permission-denied-sock/docker24-wsl2",
  "error": {
    "signature": "Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock",
    "regex": "Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker\\.sock",
    "domain": "docker",
    "category": "permissions",
    "first_seen": "2020-01-01",
    "last_confirmed": "2025-05-08"
  },
  "environment": {
    "runtime": {
      "name": "docker",
      "version_range": ">=20,<26"
    },
    "os": "linux",
    "additional": {
      "platform": "wsl2"
    }
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.85,
    "confidence": 0.82,
    "last_updated": "2025-05-08",
    "summary": "Docker socket permission denied on WSL2 has multiple root causes beyond the standard Linux group membership issue. Docker Desktop for Windows manages the socket differently through WSL integration, and the socket may not be properly forwarded if Docker Desktop's WSL2 integration is misconfigured or the WSL distro is not enabled in Docker Desktop settings."
  },
  "dead_ends": [
    {
      "action": "Running chmod 777 /var/run/docker.sock inside WSL2",
      "why_fails": "The Docker socket in WSL2 is managed by Docker Desktop's WSL integration. Changing permissions is overridden whenever Docker Desktop restarts or the WSL distro is restarted. This also poses the same security risks as on native Linux.",
      "fail_rate": 0.5,
      "sources": [
        "https://docs.docker.com/engine/install/linux-postinstall/"
      ],
      "common_misconception": "The socket in WSL2 is not a regular Linux socket; it is a proxy managed by Docker Desktop. Permission changes do not persist and do not address the root cause."
    },
    {
      "action": "Installing Docker Engine natively inside WSL2 alongside Docker Desktop",
      "why_fails": "Running both Docker Desktop's WSL integration and a native Docker Engine inside the same WSL2 distro causes socket conflicts, iptables collisions, and unpredictable behavior. The two Docker daemons compete for the same resources.",
      "fail_rate": 0.75,
      "sources": [
        "https://docs.docker.com/desktop/features/wsl/"
      ]
    }
  ],
  "workarounds": [
    {
      "action": "Enable WSL2 integration for your distro in Docker Desktop settings",
      "how": "Open Docker Desktop > Settings > Resources > WSL Integration. Ensure 'Enable integration with my default WSL distro' is checked, and toggle on the specific distro you are using. Restart Docker Desktop and restart WSL with 'wsl --shutdown' from PowerShell.",
      "success_rate": 0.88,
      "tradeoff": "Requires Docker Desktop (which requires a license for commercial use in organizations with >250 employees or >$10M revenue)",
      "sources": [
        "https://docs.docker.com/desktop/wsl/"
      ]
    },
    {
      "action": "Add user to docker group and restart WSL",
      "how": "Inside WSL2: 'sudo usermod -aG docker $USER'. Then from Windows PowerShell: 'wsl --shutdown'. Reopen your WSL terminal. Verify with 'docker ps'.",
      "success_rate": 0.78,
      "tradeoff": "Requires a full WSL restart (wsl --shutdown), which closes all WSL terminals and running processes",
      "sources": [
        "https://docs.docker.com/desktop/features/wsl/"
      ]
    },
    {
      "action": "Use Docker Engine natively in WSL2 without Docker Desktop",
      "how": "Uninstall Docker Desktop. Inside WSL2, install Docker Engine following the standard Linux instructions for your distro. Start the daemon with 'sudo service docker start'. Add your user to the docker group. Note: you must start the daemon manually or configure it to start with your WSL session.",
      "success_rate": 0.8,
      "tradeoff": "Loses Docker Desktop GUI, Kubernetes integration, and automatic daemon management. Must manually start Docker on each WSL session.",
      "condition": "Docker Desktop license is not available or not desired",
      "sources": [
        "https://docs.docker.com/engine/install/ubuntu/"
      ]
    }
  ],
  "transition_graph": {
    "leads_to": [],
    "preceded_by": [
      {
        "error_id": "docker/desktop-wsl-integration/docker24-wsl2",
        "probability": 0.45,
        "condition": "Docker Desktop WSL integration was not enabled or became disconnected after an update"
      }
    ],
    "frequently_confused_with": [
      {
        "error_id": "docker/daemon-not-running/docker24-wsl2",
        "distinction": "Permission denied means the socket exists but access is blocked. 'Cannot connect' means the socket does not exist, usually because Docker Desktop is not running or WSL integration is disabled. Check 'ls -la /var/run/docker.sock' to distinguish."
      }
    ]
  },
  "metadata": {
    "generated_by": "deadend-seed-v1",
    "generation_date": "2025-06-01",
    "review_status": "auto_generated",
    "evidence_count": 29,
    "page_views": 0,
    "ai_agent_hits": 0,
    "human_hits": 0,
    "last_verification": "2025-06-01"
  }
}
