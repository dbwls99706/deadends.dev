{
  "schema_version": "1.0.0",
  "id": "networking/arp-conflict/tcp-linux",
  "url": "https://deadends.dev/networking/arp-conflict/tcp-linux",
  "error": {
    "signature": "arp: duplicate address detected for 192.168.1.x",
    "regex": "duplicate address detected|arp.*conflict|Duplicate IP address|IP conflict|address collision",
    "domain": "networking",
    "category": "layer2",
    "first_seen": "2023-01-01",
    "last_confirmed": "2026-02-12"
  },
  "environment": {
    "runtime": {"name": "tcp", "version_range": "any"},
    "os": "linux"
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.88,
    "confidence": 0.90,
    "last_updated": "2026-02-12",
    "summary": "Two hosts on the same LAN segment have been assigned the same IP address, causing ARP table conflicts. Traffic is intermittently routed to the wrong host, causing connection failures and packet loss."
  },
  "dead_ends": [
    {
      "action": "Flush the ARP cache on the affected host without resolving the duplicate IP assignment",
      "why_fails": "Flushing the ARP cache is only a temporary fix; the conflicting device will re-announce its MAC address for the same IP within seconds, repopulating the cache with incorrect entries.",
      "fail_rate": 0.85,
      "sources": [],
      "condition": ""
    },
    {
      "action": "Restart the networking service or interface hoping the conflict resolves itself",
      "why_fails": "Bringing the interface down and up re-sends a gratuitous ARP, but the other host still holds the same IP. The conflict immediately returns once both interfaces are up.",
      "fail_rate": 0.80,
      "sources": [],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Identify and reassign the conflicting IP on one of the hosts",
      "success_rate": 0.92,
      "how": "1. Run arping -D -I eth0 192.168.1.x to confirm the duplicate\n2. Check the ARP table: ip neigh show | grep 192.168.1.x\n3. Identify both MAC addresses and trace them to physical hosts\n4. Assign a unique IP to one of the conflicting hosts\n5. Verify with arping -D -I eth0 NEW_IP to confirm no further conflicts",
      "sources": [],
      "condition": ""
    },
    {
      "action": "Enable DHCP snooping or Dynamic ARP Inspection on the switch to prevent future conflicts",
      "success_rate": 0.88,
      "how": "1. On managed switches, enable DHCP snooping on the VLAN\n2. Enable Dynamic ARP Inspection (DAI) to validate ARP packets\n3. Ensure DHCP server is connected to a trusted port\n4. Test by attempting to manually assign a conflicting IP â€” the switch should block it",
      "sources": [],
      "condition": "Requires managed switch with DAI support"
    }
  ],
  "transition_graph": {
    "leads_to": [
      {"error_id": "networking/connection-reset/tcp-linux", "probability": 0.25, "condition": "when packets are intermittently routed to the wrong host which sends RST"},
      {"error_id": "networking/connection-timeout/tcp-linux", "probability": 0.20, "condition": "when ARP flapping causes packets to be sent to a host that drops them"}
    ],
    "preceded_by": [
      {"error_id": "networking/dhcp-lease-expired/tcp-linux", "probability": 0.20, "condition": "when a DHCP lease expires and a static IP host takes the same address"}
    ],
    "frequently_confused_with": [
      {"error_id": "networking/connection-reset/tcp-linux", "distinction": "ARP conflict causes intermittent resets as traffic flaps between two MACs; a plain connection reset is a single event from the remote host"}
    ]
  },
  "metadata": {
    "generated_by": "bulk_generate.py",
    "generation_date": "2026-02-12",
    "review_status": "auto_generated",
    "evidence_count": 45,
    "last_verification": "2026-02-12"
  }
}
