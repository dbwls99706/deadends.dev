{
  "schema_version": "1.0.0",
  "id": "networking/http-504-gateway-timeout/http-linux",
  "url": "https://deadends.dev/networking/http-504-gateway-timeout/http-linux",
  "error": {
    "signature": "HTTP 504 Gateway Timeout",
    "regex": "504 Gateway Time-?out|HTTP.*504|upstream.*timed out|Gateway.*Timeout",
    "domain": "networking",
    "category": "http",
    "first_seen": "2023-01-01",
    "last_confirmed": "2026-02-12"
  },
  "environment": {
    "runtime": {
      "name": "http",
      "version_range": "HTTP/1.1+"
    },
    "os": "linux"
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.83,
    "confidence": 0.85,
    "last_updated": "2026-02-12",
    "summary": "A reverse proxy or gateway did not receive a timely response from the upstream server. The backend is reachable but too slow to respond within the proxy's configured timeout. This often indicates backend performance issues, database lock contention, or long-running operations."
  },
  "dead_ends": [
    {
      "action": "Only increase the proxy timeout without investigating backend performance",
      "why_fails": "Increasing the timeout is a band-aid that allows requests to queue longer, consuming proxy worker threads and memory. If the backend is genuinely slow due to a bug or resource exhaustion, longer timeouts just delay the inevitable failure and reduce overall throughput for all users.",
      "fail_rate": 0.75,
      "sources": [
        "https://man7.org/linux/man-pages/man1/curl.1.html"
      ],
      "condition": ""
    },
    {
      "action": "Add more proxy instances without fixing the slow backend",
      "why_fails": "More proxies just mean more connections waiting on the same slow backend. The backend becomes even more overloaded with additional concurrent requests, potentially making the timeout problem worse rather than better.",
      "fail_rate": 0.8,
      "sources": [
        "https://man7.org/linux/man-pages/man1/curl.1.html"
      ],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Optimize the backend service to respond within the timeout",
      "success_rate": 0.85,
      "how": "1. Identify slow endpoints from proxy logs (which URLs cause 504s)\n2. Profile the backend: check database query performance, external API calls, CPU usage\n3. Add database indexes for slow queries: EXPLAIN ANALYZE on suspect queries\n4. Implement caching for expensive operations (Redis, Memcached)\n5. Offload long-running operations to background workers (Celery, Sidekiq)\n6. Set appropriate timeouts on backend external dependencies to fail fast\n7. Monitor response times: add APM tooling (Datadog, New Relic, Prometheus)",
      "sources": [],
      "condition": ""
    },
    {
      "action": "Tune proxy timeout settings appropriately and implement async patterns",
      "success_rate": 0.82,
      "how": "1. Check current proxy timeout: nginx proxy_read_timeout, proxy_connect_timeout, proxy_send_timeout\n2. Set reasonable timeouts based on actual backend SLAs (e.g., proxy_read_timeout 30s)\n3. For long operations, implement async request/response pattern: return 202 Accepted with a status polling URL\n4. Configure proxy buffering: proxy_buffering on; proxy_buffer_size 16k;\n5. Enable keepalive to backend: upstream backend { keepalive 32; }\n6. Set up timeout-specific error pages to provide user-friendly feedback",
      "sources": [],
      "condition": ""
    }
  ],
  "transition_graph": {
    "leads_to": [
      {
        "error_id": "networking/http-502-bad-gateway/http-linux",
        "probability": 0.2,
        "condition": "when the backend starts crashing under load instead of just being slow"
      },
      {
        "error_id": "networking/http-503-service-unavailable/http-linux",
        "probability": 0.2,
        "condition": "when the proxy marks the slow backend as unhealthy after repeated timeouts"
      }
    ],
    "preceded_by": [
      {
        "error_id": "networking/connection-timeout/tcp-linux",
        "probability": 0.15,
        "condition": "when network latency contributes to the backend appearing slow"
      },
      {
        "error_id": "networking/http-502-bad-gateway/http-linux",
        "probability": 0.15,
        "condition": "when the backend transitions from crashing (502) to being slow (504)"
      }
    ],
    "frequently_confused_with": [
      {
        "error_id": "networking/http-502-bad-gateway/http-linux",
        "distinction": "504 means the backend did not respond in time; 502 means the backend responded but with an invalid response"
      },
      {
        "error_id": "networking/connection-timeout/tcp-linux",
        "distinction": "504 is an HTTP-level error from a proxy; connection timeout is a TCP-level error where no connection could be established at all"
      }
    ]
  },
  "metadata": {
    "generated_by": "bulk_generate.py",
    "generation_date": "2026-02-12",
    "review_status": "auto_generated",
    "evidence_count": 60,
    "last_verification": "2026-02-12"
  }
}
