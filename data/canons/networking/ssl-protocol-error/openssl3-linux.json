{
  "schema_version": "1.0.0",
  "id": "networking/ssl-protocol-error/openssl3-linux",
  "url": "https://deadends.dev/networking/ssl-protocol-error/openssl3-linux",
  "error": {
    "signature": "SSL: handshake failure / protocol error",
    "regex": "SSL.*handshake.*fail|ssl.*protocol.*error|SSL_ERROR_HANDSHAKE_FAILURE_ALERT|ERR_SSL_PROTOCOL_ERROR",
    "domain": "networking",
    "category": "ssl_tls",
    "first_seen": "2023-01-01",
    "last_confirmed": "2026-02-12"
  },
  "environment": {
    "runtime": {
      "name": "openssl",
      "version_range": "3.x"
    },
    "os": "linux"
  },
  "verdict": {
    "resolvable": "true",
    "fix_success_rate": 0.85,
    "confidence": 0.84,
    "last_updated": "2026-02-12",
    "summary": "The SSL/TLS handshake between client and server failed due to a protocol negotiation error. This typically occurs when there is no common TLS version, cipher suite, or when the handshake message sequence is corrupted."
  },
  "dead_ends": [
    {
      "action": "Force the client to use SSL 3.0 or TLS 1.0 to maximize compatibility",
      "why_fails": "SSL 3.0 is vulnerable to POODLE and TLS 1.0 to BEAST. Most modern servers disable these protocols entirely, so forcing them will result in the same handshake failure or a different error. OpenSSL 3.x has removed SSL 3.0 support by default.",
      "fail_rate": 0.9,
      "sources": [
        "https://man7.org/linux/man-pages/man1/openssl.1ssl.html"
      ],
      "condition": ""
    },
    {
      "action": "Disable all cipher suite restrictions to allow any cipher",
      "why_fails": "Setting cipher strings to ALL or COMPLEMENTOFALL enables insecure ciphers that servers may still reject. OpenSSL 3.x has deprecated many legacy ciphers, and enabling them requires loading the legacy provider which introduces security risks.",
      "fail_rate": 0.75,
      "sources": [
        "https://man7.org/linux/man-pages/man1/openssl.1ssl.html"
      ],
      "condition": ""
    }
  ],
  "workarounds": [
    {
      "action": "Align TLS version and cipher suite support between client and server",
      "success_rate": 0.88,
      "how": "1. Check server supported protocols: nmap --script ssl-enum-ciphers -p 443 host\n2. Check client capabilities: openssl ciphers -v\n3. Set minimum TLS version on client: -tls1_2 or -tls1_3 flag in openssl s_client\n4. Configure cipher suites: openssl s_client -connect host:443 -cipher 'ECDHE+AESGCM'\n5. For OpenSSL 3.x, ensure security level is appropriate: @SECLEVEL=1 for legacy compatibility",
      "sources": [],
      "condition": ""
    },
    {
      "action": "Update OpenSSL and server software to support TLS 1.3",
      "success_rate": 0.85,
      "how": "1. Check current OpenSSL version: openssl version\n2. Update OpenSSL: apt update && apt install -y openssl libssl-dev\n3. Update server software (nginx, apache, etc.) to versions supporting TLS 1.3\n4. Configure server for TLS 1.2+ only: ssl_protocols TLSv1.2 TLSv1.3;\n5. Test handshake: openssl s_client -connect host:443 -tls1_3",
      "sources": [],
      "condition": ""
    }
  ],
  "transition_graph": {
    "leads_to": [
      {
        "error_id": "networking/tls-version-unsupported/openssl3-linux",
        "probability": 0.25,
        "condition": "when the protocol error is specifically due to TLS version mismatch"
      },
      {
        "error_id": "networking/connection-reset/tcp-linux",
        "probability": 0.15,
        "condition": "when the server abruptly terminates the connection after handshake failure"
      }
    ],
    "preceded_by": [
      {
        "error_id": "networking/tls-version-unsupported/openssl3-linux",
        "probability": 0.2,
        "condition": "when attempting to work around version issues introduces cipher mismatches"
      },
      {
        "error_id": "networking/ssl-unable-to-verify/openssl3-linux",
        "probability": 0.1,
        "condition": "when updating OpenSSL to fix verification changes default protocol settings"
      }
    ],
    "frequently_confused_with": [
      {
        "error_id": "networking/tls-version-unsupported/openssl3-linux",
        "distinction": "Protocol errors cover all handshake failures including cipher mismatches; TLS version unsupported is specifically about the TLS version negotiation failing"
      },
      {
        "error_id": "networking/connection-reset/tcp-linux",
        "distinction": "Protocol errors occur during TLS negotiation; connection reset is a TCP-level event that can happen at any point and may have non-TLS causes"
      }
    ]
  },
  "metadata": {
    "generated_by": "bulk_generate.py",
    "generation_date": "2026-02-12",
    "review_status": "auto_generated",
    "evidence_count": 48,
    "last_verification": "2026-02-12"
  }
}
